{% extends 'base.html.twig' %}

{% block title %}Coupon index
{% endblock %}

{% block body %}
	<h1>Coupon
	</h1>
	<h4>
		{{ training.trainingRequest.trainingTopic.name }}
	</h4>


	<table class="table">

		<tr>
			{% for coupon in alldirectorates %}
				<td class="badge bg-lg bg-light-info  ">
					{{ coupon.name }}={{ coupon.coupons|length }}
					<br>
					Employees:{{ coupon.users|length }}<p>
						{% set quota =coupon.users|length * 100 / allusers|length %}
						Quota:
						{{ quota|number_format(0, '.', ',')}}
						%
					</p>
				</td>
			{% endfor %}
			<td class="badge bg-lg bg-light-info  ">
				Issued :{{coupons|length}}
				<br>
				Requested:
				{{training.trainingRequest.numberOfParticipants}}
			</td>
		</tr>
	</table>
	<a href="{{ path('app_training_index') }}">back to training</a>

	<table class="table">
		<thead>
			<tr>
				<th>Id</th>
				<th>CouponNumber</th>
				<th>Directorate</th>
				{# <th>Training</th> #}
				<th>Status</th>
				<th>actions</th>
			</tr>
		</thead>
		<tbody>
			{% for coupon in coupons %}
				<tr>
					<td>{{ loop.index  }}</td>
					<td>{{ coupon.couponNumber }}</td>
					<td>{{ coupon.directorate.name }}</td>
					<td>
						{% if coupon.reservedAt %}
							<span class="label label-lg label-light-danger label-inline">
								Reserved
								{{ coupon.reservedAt ? coupon.reservedAt|date('Y-m-d H:i') : '' }}</span>

						{% else %}
							<span class="label label-lg label-light-success label-inline">Free</span>
						{% endif %}
					</td>
					{# <td>{{ coupon.createdAt ? coupon.createdAt|date('Y-m-d H:i:s') : '' }}</td> #}
					<td>
						<a href="{{ path('app_coupon_show', {'id': coupon.id}) }}">show</a>
						<a href="{{ path('app_coupon_edit', {'id': coupon.id}) }}">edit</a>
					</td>
				</tr>
			{% else %}
				<tr>
					<td colspan="5">no records found</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	<div class="navigation">
		{{ knp_pagination_render(coupons) }}
	</div>

{% endblock %}
